{"version":3,"sources":["../src/NativeSerializer.js"],"names":["allowedMapObjectTypes","serializeForNativeLayer","map","maxDepth","depth","seen","Set","add","output","key","hasOwnProperty","call","value","undefined","includes","isNaN","type","String","has","console","warn"],"mappings":"yDAAA,GAAMA,uBAAwB,CAAE,QAAF,CAAY,QAAZ,CAAsB,SAAtB,CAA9B;;;;;;AAMA,GAAMC,yBAA0B,QAA1BA,wBAA0B,CAACC,GAAD,CAAqD,IAA/CC,SAA+C,2DAApC,EAAoC,IAAhCC,MAAgC,2DAAxB,CAAwB,IAArBC,KAAqB,2DAAd,GAAIC,IAAJ,EAAc;AACnFD,KAAKE,GAAL,CAASL,GAAT;AACA,GAAMM,QAAS,EAAf;AACA,IAAK,GAAMC,IAAX,GAAkBP,IAAlB,CAAuB;AACrB,GAAI,CAAC,GAAGQ,cAAH,CAAkBC,IAAlB,CAAuBT,GAAvB,CAA4BO,GAA5B,CAAL,CAAuC;;AAEvC,GAAMG,OAAQV,IAAIO,GAAJ,CAAd;;;AAGA,GAAI,CAAEI,SAAF,CAAa,IAAb,EAAoBC,QAApB,CAA6BF,KAA7B,GAAwC,MAAOA,MAAP,GAAiB,QAAjB,EAA6BG,MAAMH,KAAN,CAAzE,CAAwF;AACtFJ,OAAOC,GAAP,EAAc,CAAEO,KAAM,QAAR,CAAkBJ,MAAOK,OAAOL,KAAP,CAAzB,CAAd;AACD,CAFD,IAEO,IAAI,MAAOA,MAAP,GAAiB,QAArB,CAA+B;AACpC,GAAIP,KAAKa,GAAL,CAASN,KAAT,CAAJ,CAAqB;AACnBJ,OAAOC,GAAP,EAAc,CAAEO,KAAM,QAAR,CAAkBJ,MAAO,YAAzB,CAAd;AACD,CAFD,IAEO,IAAIR,QAAUD,QAAd,CAAwB;AAC7BK,OAAOC,GAAP,EAAc,CAAEO,KAAM,QAAR,CAAkBJ,MAAO,sBAAzB,CAAd;AACD,CAFM,IAEA;AACLJ,OAAOC,GAAP,EAAc,CAAEO,KAAM,KAAR,CAAeJ,MAAOX,wBAAwBW,KAAxB,CAA+BT,QAA/B,CAAyCC,MAAQ,CAAjD,CAAoDC,IAApD,CAAtB,CAAd;AACD;AACF,CARM,IAQA;AACL,GAAMW,MAAO,MAAOJ,MAApB;AACA,GAAIZ,sBAAsBc,QAAtB,CAA+BE,IAA/B,CAAJ,CAA0C;AACxCR,OAAOC,GAAP,EAAc,CAAEO,KAAMA,IAAR,CAAcJ,MAAOA,KAArB,CAAd;AACD,CAFD,IAEO;AACLO,QAAQC,IAAR,8CAAyDX,GAAzD,uBAAgFO,IAAhF;AACD;AACF;AACF;AACD,MAAOR,OAAP;AACD,CA7BD,C;;AA+BeP,uB","file":"NativeSerializer.js","sourcesContent":["const allowedMapObjectTypes = [ 'string', 'number', 'boolean' ]\n\n/**\n * Convert an object into a structure with types suitable for serializing\n * across to native code.\n */\nconst serializeForNativeLayer = (map, maxDepth = 10, depth = 0, seen = new Set()) => {\n  seen.add(map)\n  const output = {}\n  for (const key in map) {\n    if (!{}.hasOwnProperty.call(map, key)) continue\n\n    const value = map[key]\n\n    // Checks for `null`, NaN, and `undefined`.\n    if ([ undefined, null ].includes(value) || (typeof value === 'number' && isNaN(value))) {\n      output[key] = { type: 'string', value: String(value) }\n    } else if (typeof value === 'object') {\n      if (seen.has(value)) {\n        output[key] = { type: 'string', value: '[circular]' }\n      } else if (depth === maxDepth) {\n        output[key] = { type: 'string', value: '[max depth exceeded]' }\n      } else {\n        output[key] = { type: 'map', value: serializeForNativeLayer(value, maxDepth, depth + 1, seen) }\n      }\n    } else {\n      const type = typeof value\n      if (allowedMapObjectTypes.includes(type)) {\n        output[key] = { type: type, value: value }\n      } else {\n        console.warn(`Could not serialize breadcrumb data for '${key}': Invalid type '${type}'`)\n      }\n    }\n  }\n  return output\n}\n\nexport default serializeForNativeLayer\n"]}